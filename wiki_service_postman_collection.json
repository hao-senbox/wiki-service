{
  "info": {
    "name": "Wiki Service API Test Collection",
    "description": "Comprehensive test collection for Wiki Service APIs",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "version": "1.0.0"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{auth_token}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8023",
      "type": "string"
    },
    {
      "key": "auth_token",
      "value": "YOUR_JWT_TOKEN_HERE",
      "type": "string"
    },
    {
      "key": "wiki_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "template_type",
      "value": "product",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "1. Template Management",
      "item": [
        {
          "name": "Create Product Template",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"{{template_type}}\",\n  \"elements\": [\n    {\n      \"number\": 1,\n      \"type\": \"text\",\n      \"value\": \"Product Name\"\n    },\n    {\n      \"number\": 2,\n      \"type\": \"image\",\n      \"value\": \"product_main.jpg\"\n    },\n    {\n      \"number\": 3,\n      \"type\": \"picture\",\n      \"picture_keys\": [\"gallery1.jpg\", \"gallery2.jpg\", \"gallery3.jpg\"]\n    },\n    {\n      \"number\": 4,\n      \"type\": \"banner\",\n      \"value\": \"banner.jpg\"\n    },\n    {\n      \"number\": 5,\n      \"type\": \"large_picture\",\n      \"value\": \"large_banner.jpg\"\n    },\n    {\n      \"number\": 6,\n      \"type\": \"linked_in\",\n      \"value\": \"linkedin_banner.jpg\"\n    },\n    {\n      \"number\": 7,\n      \"type\": \"graphic\",\n      \"value\": \"graphic.jpg\"\n    },\n    {\n      \"number\": 8,\n      \"type\": \"document\",\n      \"value\": \"manual.pdf\"\n    },\n    {\n      \"number\": 9,\n      \"type\": \"button\",\n      \"value\": \"{\\\"title\\\":\\\"Buy Now\\\",\\\"button_icon\\\":\\\"cart_icon.png\\\"}\"\n    },\n    {\n      \"number\": 10,\n      \"type\": \"button_url\",\n      \"value\": \"{\\\"title\\\":\\\"Learn More\\\",\\\"url\\\":\\\"https://example.com\\\",\\\"button_icon\\\":\\\"info_icon.png\\\"}\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/wikis/template",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis", "template"]
            },
            "description": "Create a wiki template and generate 6000 wiki instances"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 201\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test(\"Response has success true\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Template",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/wikis/template?type={{template_type}}",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis", "template"],
              "query": [
                {
                  "key": "type",
                  "value": "{{template_type}}"
                }
              ]
            },
            "description": "Retrieve the created template"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Template data exists\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    pm.expect(jsonData.data).to.not.be.null;",
                  "    pm.expect(jsonData.data.type).to.eql(\"product\");",
                  "});"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "2. Wiki Operations",
      "item": [
        {
          "name": "Get First Wiki (0001)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/wikis/code?code=0001&type={{template_type}}",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis", "code"],
              "query": [
                {
                  "key": "code",
                  "value": "0001"
                },
                {
                  "key": "type",
                  "value": "{{template_type}}"
                }
              ]
            },
            "description": "Get wiki with code 0001"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Wiki data is correct\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    pm.expect(jsonData.data.code).to.eql(\"0001\");",
                  "    pm.expect(jsonData.data.translation).to.be.an('array');",
                  "});",
                  "",
                  "pm.test(\"Store wiki ID\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set(\"wiki_id\", jsonData.data.id);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Wikis List",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/wikis?page=1&limit=10&type={{template_type}}",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "type",
                  "value": "{{template_type}}"
                }
              ]
            },
            "description": "Get paginated list of wikis"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has pagination\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    pm.expect(jsonData.data.items).to.be.an('array');",
                  "    pm.expect(jsonData.data.total).to.be.at.least(6000);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Search Wikis by Code",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/wikis?page=1&limit=5&type={{template_type}}&search=0001",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "5"
                },
                {
                  "key": "type",
                  "value": "{{template_type}}"
                },
                {
                  "key": "search",
                  "value": "0001"
                }
              ]
            },
            "description": "Search wikis by code"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Search results contain 0001\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data.items).to.be.an('array');",
                  "    if (jsonData.data.items.length > 0) {",
                  "        pm.expect(jsonData.data.items[0].code).to.include('0001');",
                  "    }",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Wiki by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/wikis/{{wiki_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis", "{{wiki_id}}"]
            },
            "description": "Get specific wiki by ID"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Wiki ID matches\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data.id).to.eql(pm.collectionVariables.get(\"wiki_id\"));",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Wiki - English Translation",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"language\": 1,\n  \"title\": \"Amazing Product - English\",\n  \"keywords\": \"product, amazing, english\",\n  \"level\": 3,\n  \"unit\": \"pieces\",\n  \"elements\": [\n    {\n      \"number\": 1,\n      \"type\": \"text\",\n      \"value\": \"Amazing product description in English\"\n    },\n    {\n      \"number\": 2,\n      \"type\": \"image\",\n      \"value\": \"product_en.jpg\"\n    },\n    {\n      \"number\": 3,\n      \"type\": \"picture\",\n      \"picture_keys\": [\"gallery_en1.jpg\", \"gallery_en2.jpg\"]\n    },\n    {\n      \"number\": 4,\n      \"type\": \"banner\",\n      \"value\": \"banner_en.jpg\"\n    },\n    {\n      \"number\": 5,\n      \"type\": \"button\",\n      \"value\": \"{\\\"title\\\":\\\"Buy Now\\\",\\\"button_icon\\\":\\\"cart_en.png\\\"}\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/wikis/{{wiki_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis", "{{wiki_id}}"]
            },
            "description": "Update wiki with English translation"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Update successful\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Wiki - Vietnamese Translation",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"language\": 2,\n  \"title\": \"Sản phẩm Tuyệt vời - Tiếng Việt\",\n  \"keywords\": \"sản phẩm, tuyệt vời, tiếng việt\",\n  \"level\": 3,\n  \"unit\": \"cái\",\n  \"elements\": [\n    {\n      \"number\": 1,\n      \"type\": \"text\",\n      \"value\": \"Mô tả sản phẩm tuyệt vời bằng tiếng Việt\"\n    },\n    {\n      \"number\": 2,\n      \"type\": \"image\",\n      \"value\": \"product_vn.jpg\"\n    },\n    {\n      \"number\": 3,\n      \"type\": \"picture\",\n      \"picture_keys\": [\"gallery_vn1.jpg\", \"gallery_vn2.jpg\"]\n    },\n    {\n      \"number\": 4,\n      \"type\": \"banner\",\n      \"value\": \"banner_vn.jpg\"\n    },\n    {\n      \"number\": 5,\n      \"type\": \"button\",\n      \"value\": \"{\\\"title\\\":\\\"Mua Ngay\\\",\\\"button_icon\\\":\\\"cart_vn.png\\\"}\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/wikis/{{wiki_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis", "{{wiki_id}}"]
            },
            "description": "Update wiki with Vietnamese translation"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Wiki with English Filter",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/wikis/{{wiki_id}}?language=1",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis", "{{wiki_id}}"],
              "query": [
                {
                  "key": "language",
                  "value": "1"
                }
              ]
            },
            "description": "Get wiki filtered by English language"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"English translation only\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data.translation).to.be.an('array');",
                  "    pm.expect(jsonData.data.translation.length).to.eql(1);",
                  "    pm.expect(jsonData.data.translation[0].language).to.eql(1);",
                  "    pm.expect(jsonData.data.translation[0].title).to.include('English');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Wiki with Vietnamese Filter",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/wikis/{{wiki_id}}?language=2",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis", "{{wiki_id}}"],
              "query": [
                {
                  "key": "language",
                  "value": "2"
                }
              ]
            },
            "description": "Get wiki filtered by Vietnamese language"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Vietnamese translation only\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data.translation).to.be.an('array');",
                  "    pm.expect(jsonData.data.translation.length).to.eql(1);",
                  "    pm.expect(jsonData.data.translation[0].language).to.eql(2);",
                  "    pm.expect(jsonData.data.translation[0].title).to.include('Tiếng Việt');",
                  "});"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "3. Statistics",
      "item": [
        {
          "name": "Get Statistics Overview",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/wikis/statistics?page=1&limit=20&type={{template_type}}",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis", "statistics"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                },
                {
                  "key": "type",
                  "value": "{{template_type}}"
                }
              ]
            },
            "description": "Get statistics for all wikis"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Statistics structure\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    pm.expect(jsonData.data).to.be.an('array');",
                  "    if (jsonData.data.length > 0) {",
                  "        var firstStat = jsonData.data[0];",
                  "        pm.expect(firstStat).to.have.property('code');",
                  "        pm.expect(firstStat).to.have.property('languages');",
                  "        pm.expect(firstStat).to.have.property('elements');",
                  "        pm.expect(firstStat.languages).to.have.property('1');",
                  "        pm.expect(firstStat.languages).to.have.property('2');",
                  "    }",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Search Statistics",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/wikis/statistics?page=1&limit=10&type={{template_type}}&search=0001",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis", "statistics"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "type",
                  "value": "{{template_type}}"
                },
                {
                  "key": "search",
                  "value": "0001"
                }
              ]
            },
            "description": "Search statistics by code"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Search results\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.be.an('array');",
                  "});"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "4. Error Scenarios",
      "item": [
        {
          "name": "Invalid Wiki ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/wikis/invalid_id_123",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis", "invalid_id_123"]
            },
            "description": "Try to get wiki with invalid ID"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Error response\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(false);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Missing Type Parameter",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/wikis?page=1&limit=10",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "Try to get wikis without type parameter"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Invalid Code Format",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/wikis/code?code=9999&type={{template_type}}",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis", "code"],
              "query": [
                {
                  "key": "code",
                  "value": "9999"
                },
                {
                  "key": "type",
                  "value": "{{template_type}}"
                }
              ]
            },
            "description": "Try to get wiki with non-existent code"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 404 or error response\", function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([404, 500]);",
                  "});"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "5. Advanced Scenarios",
      "item": [
        {
          "name": "Update with Partial Elements",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"language\": 1,\n  \"title\": \"Partially Updated Product\",\n  \"elements\": [\n    {\n      \"number\": 1,\n      \"type\": \"text\",\n      \"value\": \"Only updating first element\"\n    },\n    {\n      \"number\": 3,\n      \"type\": \"picture\",\n      \"picture_keys\": [\"partial_update1.jpg\"]\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/wikis/{{wiki_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis", "{{wiki_id}}"]
            },
            "description": "Update only some elements, others should remain unchanged"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Create New Translation",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"language\": 3,\n  \"title\": \"French Translation\",\n  \"keywords\": \"produit, français\",\n  \"level\": 2,\n  \"unit\": \"pièces\",\n  \"elements\": [\n    {\n      \"number\": 1,\n      \"type\": \"text\",\n      \"value\": \"Description en français\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/wikis/{{wiki_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis", "{{wiki_id}}"]
            },
            "description": "Create a new translation for language 3 (French)"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Large Scale Search",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/wikis?page=1&limit=100&type={{template_type}}&search=product",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wikis"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "100"
                },
                {
                  "key": "type",
                  "value": "{{template_type}}"
                },
                {
                  "key": "search",
                  "value": "product"
                }
              ]
            },
            "description": "Test search performance with larger result set"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Large result set\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data.items.length).to.be.at.most(100);",
                  "});"
                ]
              }
            }
          ]
        }
      ]
    }
  ]
}
